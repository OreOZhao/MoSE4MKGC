from typing import Dict

import torch


def avg_both(mrs: Dict[str, float], mrrs: Dict[str, float], hits: Dict[str, torch.FloatTensor]):
    """
    aggregate metrics for missing lhs and rhs
    :param mrrs: d
    :param hits:
    :return:
    """
    mr = (mrs['lhs'] + mrs['rhs']) / 2
    mrr = (mrrs['lhs'] + mrrs['rhs']) / 2.
    h = (hits['lhs'] + hits['rhs']) / 2.
    return {'MR': mr, 'MRR': mrr, 'hits@[1,3,10]': h.tolist()}


def read_tab_file(tabfile):
    ents = []
    others = []
    for line in open(tabfile, 'r'):
        ent, other = line.strip().split('\t')
        ents.append(ent)
        others.append(other)
    return ents, others


